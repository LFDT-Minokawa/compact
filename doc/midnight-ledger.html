<!DOCTYPE html>
<html>
<head>
<meta http-equiv=Content-Type content="text/html;charset=utf-8">
<title>Midnight Ledger ADTs</title>
</head><body><h2>Ledger ADTs and operations upon them</h2>
<p>Compact language version 0.14.100, compiler version 0.21.106.</p>
<p><b>Kernel(</b><b>)</b></p>
<blockquote>This ADT is a special ADT defining various built-in operations and valid only as a top-level ADT type.</blockquote>
<blockquote><p><b>checkpoint</b><b>(</b><b>): </b>[]
<p style="padding-left: 2em"><i>Marks all execution up to this point as being a single atomic unit, allowing partial transaction failures to be split across it.</i></p></p>
<p><b>claim_contract_call</b><b>(</b>addr: Bytes&lt;32&gt;, entry_point: Bytes&lt;32&gt;, comm: Field<b>): </b>[]
<p style="padding-left: 2em"><i>Require the presence of another contract call in the containing transaction, with a match address, entry point hash, and communication commitment, that is not claimed by any other call.</i></p></p>
<p><b>claim_zswap_coin_receive</b><b>(</b>note: Bytes&lt;32&gt;<b>): </b>[]
<p style="padding-left: 2em"><i>Requires the presence of a commitment in the containing transaction and that no other call claims it as a receive.</i></p></p>
<p><b>claim_zswap_coin_spend</b><b>(</b>note: Bytes&lt;32&gt;<b>): </b>[]
<p style="padding-left: 2em"><i>Requires the presence of a commitment in the containing transaction and that no other call claims it as a spend.</i></p></p>
<p><b>claim_zswap_nullifier</b><b>(</b>nul: Bytes&lt;32&gt;<b>): </b>[]
<p style="padding-left: 2em"><i>Requires the presence of a nullifier in the containing transaction and that no other call claims it.</i></p></p>
<p><b>mint</b><b>(</b>domain_sep: Bytes&lt;32&gt;, amount: Unsigned Integer&lt;128&gt;<b>): </b>[]
<p style="padding-left: 2em"><i>Mints a given amount of coins with a token type derived from the contract's address, adn a given domain separator.</i></p></p>
<p><b>self</b><b>(</b><b>): </b>ContractAddress
<p style="padding-left: 2em"><i>Returns the current contract's address.  ContractAddress is defined in CompactStandardLibrary.</i></p>
<p style="color: royalblue; padding-left: 2em"><i>available from Typescript as <b>self</b><b>(</b><b>): </b>ContractAddress</i></p></p>
</blockquote>
<p><b>Cell(</b>value_type<b>)</b></p>
<blockquote>This ADT is a single cell containing a value of type type value_type and is used implicity when the ledger field type is an ordinary Compact type.</blockquote>
<blockquote><p><b>read</b><b>(</b><b>): </b>value_type
<p style="padding-left: 2em"><i>Returns the current contents of this Cell.</i></p>
<p style="color: royalblue; padding-left: 2em"><i>available from Typescript as a getter on the ledger field</i></p></p>
<p><b>reset_to_default</b><b>(</b><b>): </b>[]
<p style="padding-left: 2em"><i>Resets this Cell to the default value of its type.</i></p></p>
<p><b>write</b><b>(</b>value: value_type<b>): </b>[]
<p style="padding-left: 2em"><i>Overwrites the content of this Cell with the given value.</i></p></p>
<p><b>write_coin</b><b>(</b>coin: CoinInfo, recipient: Either&lt;ZswapCoinPublicKey, ContractAddress&gt;<b>): </b>[]
<p style="padding-left: 2em"><i>Writes a CoinInfo to this Cell, which is transformed into a QualifiedCoinInfo at runtime by looking up the relevant Merkle tree index. This index must have been allocated within the current transaction or this write fails. CoinInfo, ContractAddress, Either, and ZswapCoinPublicKey are defined in CompactStandardLibrary.</i></p>
<p style="color: red; padding-left: 2em"><i>available only for QualifiedCoinInfo value_type</i></p></p>
</blockquote>
<p><b>Counter(</b><b>)</b></p>
<blockquote>This ADT is a simple counter.</blockquote>
<blockquote><p><b>decrement</b><b>(</b>amount: Unsigned Integer&lt;16&gt;<b>): </b>[]
<p style="padding-left: 2em"><i>Decrements the counter by a given amount. Decrementing below zero results in a run-time error.</i></p></p>
<p><b>increment</b><b>(</b>amount: Unsigned Integer&lt;16&gt;<b>): </b>[]
<p style="padding-left: 2em"><i>Increments the counter by the given amount.</i></p></p>
<p><b>less_than</b><b>(</b>threshold: Unsigned Integer&lt;64&gt;<b>): </b>Boolean
<p style="padding-left: 2em"><i>Returns if the counter is less than the given threshold value.</i></p></p>
<p><b>read</b><b>(</b><b>): </b>Unsigned Integer&lt;64&gt;
<p style="padding-left: 2em"><i>Retrieves the current value of the counter.</i></p>
<p style="color: royalblue; padding-left: 2em"><i>available from Typescript as a getter on the ledger field</i></p></p>
<p><b>reset_to_default</b><b>(</b><b>): </b>[]
<p style="padding-left: 2em"><i>Resets this Counter to its default value of 0.</i></p></p>
</blockquote>
<p><b>Set(</b>value_type<b>)</b></p>
<blockquote>This ADT is an unbounded set of values of type value_type.</blockquote>
<blockquote><p><b>insert</b><b>(</b>elem: value_type<b>): </b>[]
<p style="padding-left: 2em"><i>Updates this Set to include a given element.</i></p></p>
<p><b>insert_coin</b><b>(</b>coin: CoinInfo, recipient: Either&lt;ZswapCoinPublicKey, ContractAddress&gt;<b>): </b>[]
<p style="padding-left: 2em"><i>Inserts a CoinInfo into this Set, which is transformed into a QualifiedCoinInfo at runtime by looking up the relevant Merkle tree index. This index must have been allocated within the current transaction or this insertion fails. CoinInfo, ContractAddress, Either, and ZswapCoinPublicKey are defined in CompactStandardLibrary.</i></p>
<p style="color: red; padding-left: 2em"><i>available only for QualifiedCoinInfo value_type</i></p></p>
<p><b>is_empty</b><b>(</b><b>): </b>Boolean
<p style="padding-left: 2em"><i>Returns whether this Set is the empty set.</i></p>
<p style="color: royalblue; padding-left: 2em"><i>available from Typescript as <b>isEmpty</b><b>(</b><b>): </b>boolean</i></p></p>
<p><b>member</b><b>(</b>elem: value_type<b>): </b>Boolean
<p style="padding-left: 2em"><i>Returns if an element is contained within this Set.</i></p>
<p style="color: royalblue; padding-left: 2em"><i>available from Typescript as <b>member</b><b>(</b>elem: value_type<b>): </b>boolean</i></p></p>
<p><b>remove</b><b>(</b>elem: value_type<b>): </b>[]
<p style="padding-left: 2em"><i>Update this Set to not include a given element.</i></p></p>
<p><b>reset_to_default</b><b>(</b><b>): </b>[]
<p style="padding-left: 2em"><i>Resets this Set to the empty set.</i></p></p>
<p><b>size</b><b>(</b><b>): </b>Unsigned Integer&lt;64&gt;
<p style="padding-left: 2em"><i>Returns the number of unique entries in this Set.</i></p>
<p style="color: royalblue; padding-left: 2em"><i>available from Typescript as <b>size</b><b>(</b><b>): </b>bigint</i></p></p>
<p style="color: royalblue"><b>[Symbol.iterator]</b><b>(</b><b>): </b>Iterator&lt;value_type&gt;</p>
<p style="color: royalblue; padding-left: 2em"><i>Iterates over the entries in this Set.</i></p>
<p style="color: royalblue; padding-left: 2em"><i>callable only from Typescript</i></p>
</blockquote>
<p><b>Map(</b>key_type, value_type<b>)</b></p>
<blockquote>This ADT is an unbounded set of mappings between values of type key_type and values of type value_type.</blockquote>
<blockquote><p><b>insert</b><b>(</b>key: key_type, value: value_type<b>): </b>[]
<p style="padding-left: 2em"><i>Updates this Map to include a new value at a given key.</i></p></p>
<p><b>insert_coin</b><b>(</b>key: key_type, coin: CoinInfo, recipient: Either&lt;ZswapCoinPublicKey, ContractAddress&gt;<b>): </b>[]
<p style="padding-left: 2em"><i>Inserts a CoinInfo into this Map at a given key, where the CoinInfo is transformed into a QualifiedCoinInfo at runtime by looking up the relevant Merkle tree index. This index must have been allocated within the current transaction or this insertion fails. CoinInfo, ContractAddress, Either, and ZswapCoinPublicKey are defined in CompactStandardLibrary.</i></p>
<p style="color: red; padding-left: 2em"><i>available only for QualifiedCoinInfo value_type</i></p></p>
<p><b>insert_default</b><b>(</b>key: key_type<b>): </b>[]
<p style="padding-left: 2em"><i>Updates this Map to include the value type's default value at a given key.</i></p></p>
<p><b>is_empty</b><b>(</b><b>): </b>Boolean
<p style="padding-left: 2em"><i>Returns if this Map is the empty map.</i></p>
<p style="color: royalblue; padding-left: 2em"><i>available from Typescript as <b>isEmpty</b><b>(</b><b>): </b>boolean</i></p></p>
<p><b>lookup</b><b>(</b>key: key_type<b>): </b>value_type
<p style="padding-left: 2em"><i>Looks up the value of a key within this Map. The returned value may be another ADT.</i></p>
<p style="color: royalblue; padding-left: 2em"><i>available from Typescript as <b>lookup</b><b>(</b>key: key_type<b>): </b>value_type</i></p></p>
<p><b>member</b><b>(</b>key: key_type<b>): </b>Boolean
<p style="padding-left: 2em"><i>Returns if a key is contained within this Map.</i></p>
<p style="color: royalblue; padding-left: 2em"><i>available from Typescript as <b>member</b><b>(</b>key: key_type<b>): </b>boolean</i></p></p>
<p><b>remove</b><b>(</b>key: key_type<b>): </b>[]
<p style="padding-left: 2em"><i>Updates this Map to not include a given key.</i></p></p>
<p><b>reset_to_default</b><b>(</b><b>): </b>[]
<p style="padding-left: 2em"><i>Resets this Map to the empty map.</i></p></p>
<p><b>size</b><b>(</b><b>): </b>Unsigned Integer&lt;64&gt;
<p style="padding-left: 2em"><i>Returns the number of entries in this Map.</i></p>
<p style="color: royalblue; padding-left: 2em"><i>available from Typescript as <b>size</b><b>(</b><b>): </b>bigint</i></p></p>
<p style="color: royalblue"><b>[Symbol.iterator]</b><b>(</b><b>): </b>Iterator&lt;[key_type, value_type]&gt;</p>
<p style="color: royalblue; padding-left: 2em"><i>Iterates over the key-value pairs contained in this Map.</i></p>
<p style="color: royalblue; padding-left: 2em"><i>callable only from Typescript</i></p>
</blockquote>
<p><b>List(</b>value_type<b>)</b></p>
<blockquote>This ADT is an unbounded list of values of type value_type.</blockquote>
<blockquote><p><b>head</b><b>(</b><b>): </b>Maybe&lt;value_type&gt;
<p style="padding-left: 2em"><i>Retrieves the head of this List, returning a Maybe, ensuring this call succeeds on the empty list. Maybe is defined in CompactStandardLibrary (compact-runtime runtime.ts from Typescript).</i></p>
<p style="color: royalblue; padding-left: 2em"><i>available from Typescript as <b>head</b><b>(</b><b>): </b>Maybe&lt;value_type&gt;</i></p></p>
<p><b>is_empty</b><b>(</b><b>): </b>Boolean
<p style="padding-left: 2em"><i>Returns if this List is the empty list.</i></p>
<p style="color: royalblue; padding-left: 2em"><i>available from Typescript as <b>isEmpty</b><b>(</b><b>): </b>boolean</i></p></p>
<p><b>length</b><b>(</b><b>): </b>Unsigned Integer&lt;64&gt;
<p style="padding-left: 2em"><i>Returns the number of elements contained in this List.</i></p>
<p style="color: royalblue; padding-left: 2em"><i>available from Typescript as <b>length</b><b>(</b><b>): </b>bigint</i></p></p>
<p><b>pop_front</b><b>(</b><b>): </b>[]
<p style="padding-left: 2em"><i>Removes the first element from the front of this list.</i></p></p>
<p><b>push_front</b><b>(</b>value: value_type<b>): </b>[]
<p style="padding-left: 2em"><i>Pushes a new element onto the front of this list.</i></p></p>
<p><b>push_front_coin</b><b>(</b>coin: CoinInfo, recipient: Either&lt;ZswapCoinPublicKey, ContractAddress&gt;<b>): </b>[]
<p style="padding-left: 2em"><i>Pushes a CoinInfo onto the front of this List, where the CoinInfo is transformed into a QualifiedCoinInfo at runtime by looking up the relevant Merkle tree index. This index must have been allocated within the current transaction or this push fails. CoinInfo, ContractAddress, Either, and ZswapCoinPublicKey are defined in CompactStandardLibrary.</i></p>
<p style="color: red; padding-left: 2em"><i>available only for QualifiedCoinInfo value_type</i></p></p>
<p><b>reset_to_default</b><b>(</b><b>): </b>[]
<p style="padding-left: 2em"><i>Resets this List to the empty list.</i></p></p>
<p style="color: royalblue"><b>[Symbol.iterator]</b><b>(</b><b>): </b>Iterator&lt;value_type&gt;</p>
<p style="color: royalblue; padding-left: 2em"><i>Iterates over the entries in this List.</i></p>
<p style="color: royalblue; padding-left: 2em"><i>callable only from Typescript</i></p>
</blockquote>
<p><b>MerkleTree(</b>nat, value_type<b>)</b></p>
<blockquote>This ADT is a bounded Merkle tree of depth nat containing values of type value_type.</blockquote>
<blockquote><p><b>check_root</b><b>(</b>rt: MerkleTreeDigest<b>): </b>Boolean
<p style="padding-left: 2em"><i>Tests if the given Merkle tree root is the root for this Merkle tree. MerkleTreeDigest is defined in CompactStandardLibrary (compact-runtime runtime.ts from Typescript).</i></p>
<p style="color: royalblue; padding-left: 2em"><i>available from Typescript as <b>checkRoot</b><b>(</b>rt: MerkleTreeDigest<b>): </b>boolean</i></p></p>
<p><b>insert</b><b>(</b>item: value_type<b>): </b>[]
<p style="padding-left: 2em"><i>Inserts a new leaf at the first free index in this Merkle tree.</i></p></p>
<p><b>insert_hash</b><b>(</b>hash: Bytes&lt;32&gt;<b>): </b>[]
<p style="padding-left: 2em"><i>Inserts a new leaf with a given hash at the first free index in this Merkle tree.</i></p></p>
<p><b>insert_hash_index</b><b>(</b>hash: Bytes&lt;32&gt;, index: Unsigned Integer&lt;64&gt;<b>): </b>[]
<p style="padding-left: 2em"><i>Inserts a new leaf with a given hash at a specific index in this Merkle tree.</i></p></p>
<p><b>insert_index</b><b>(</b>item: value_type, index: Unsigned Integer&lt;64&gt;<b>): </b>[]
<p style="padding-left: 2em"><i>Inserts a new leaf at a specific index in this Merkle tree.</i></p></p>
<p><b>insert_index_default</b><b>(</b>index: Unsigned Integer&lt;64&gt;<b>): </b>[]
<p style="padding-left: 2em"><i>Inserts a default value leaf at a specific index in this Merkle tree. This can be used to emulate a removal from the tree.</i></p></p>
<p><b>is_full</b><b>(</b><b>): </b>Boolean
<p style="padding-left: 2em"><i>Returns if this Merkle tree is full and further items cannot be directly inserted.</i></p>
<p style="color: royalblue; padding-left: 2em"><i>available from Typescript as <b>isFull</b><b>(</b><b>): </b>boolean</i></p></p>
<p><b>reset_to_default</b><b>(</b><b>): </b>[]
<p style="padding-left: 2em"><i>Resets this Merkle tree to the empty Merkle tree.</i></p></p>
<p style="color: royalblue"><b>findPathForLeaf</b><b>(</b>leaf: value_type<b>): </b>MerkleTreePath&lt;value_type&gt; | undefined</p>
<p style="color: royalblue; padding-left: 2em"><i>Finds the path for a given leaf in a Merkle tree. Be warned that this is O(n) and should be avoided for large trees. Returns undefined if no such leaf exists. MerkleTreePath is defined in compact-runtime runtime.ts.</i></p>
<p style="color: royalblue; padding-left: 2em"><i>callable only from Typescript</i></p>
<p style="color: royalblue"><b>firstFree</b><b>(</b><b>): </b>bigint</p>
<p style="color: royalblue; padding-left: 2em"><i>Retrieves the first (guaranteed) free index in the Merkle tree.</i></p>
<p style="color: royalblue; padding-left: 2em"><i>callable only from Typescript</i></p>
<p style="color: royalblue"><b>pathForLeaf</b><b>(</b>index: bigint, leaf: value_type<b>): </b>MerkleTreePath&lt;value_type&gt;</p>
<p style="color: royalblue; padding-left: 2em"><i>Returns the Merkle path, given the knowledge that a specified leaf is at the given index. It is an error to call this if this leaf is not contained at the given index. MerkleTreePath is defined in compact-runtime runtime.ts.</i></p>
<p style="color: royalblue; padding-left: 2em"><i>callable only from Typescript</i></p>
<p style="color: royalblue"><b>root</b><b>(</b><b>): </b>MerkleTreeDigest</p>
<p style="color: royalblue; padding-left: 2em"><i>Retrieves the root of the Merkle tree. MerkleTreeDigest is defined in compact-runtime runtime.ts.</i></p>
<p style="color: royalblue; padding-left: 2em"><i>callable only from Typescript</i></p>
</blockquote>
<p><b>HistoricMerkleTree(</b>nat, value_type<b>)</b></p>
<blockquote>This ADT is a bounded Merkle tree of depth nat containing values of type value_type, with history.</blockquote>
<blockquote><p><b>check_root</b><b>(</b>rt: MerkleTreeDigest<b>): </b>Boolean
<p style="padding-left: 2em"><i>Tests if the given Merkle tree root is one of the past roots for this Merkle tree. MerkleTreeDigest is defined in CompactStandardLibrary (compact-runtime runtime.ts from Typescript).</i></p>
<p style="color: royalblue; padding-left: 2em"><i>available from Typescript as <b>checkRoot</b><b>(</b>rt: MerkleTreeDigest<b>): </b>boolean</i></p></p>
<p><b>insert</b><b>(</b>item: value_type<b>): </b>[]
<p style="padding-left: 2em"><i>Inserts a new leaf at the first free index in this Merkle tree.</i></p></p>
<p><b>insert_hash</b><b>(</b>hash: Bytes&lt;32&gt;<b>): </b>[]
<p style="padding-left: 2em"><i>Inserts a new leaf with a given hash at the first free index in this Merkle tree.</i></p></p>
<p><b>insert_hash_index</b><b>(</b>hash: Bytes&lt;32&gt;, index: Unsigned Integer&lt;64&gt;<b>): </b>[]
<p style="padding-left: 2em"><i>Inserts a new leaf with a given hash at a specific index in this Merkle tree.</i></p></p>
<p><b>insert_index</b><b>(</b>item: value_type, index: Unsigned Integer&lt;64&gt;<b>): </b>[]
<p style="padding-left: 2em"><i>Inserts a new leaf at a specific index in this Merkle tree.</i></p></p>
<p><b>insert_index_default</b><b>(</b>index: Unsigned Integer&lt;64&gt;<b>): </b>[]
<p style="padding-left: 2em"><i>Inserts a default value leaf at a specific index in this Merkle tree. This can be used to emulate a removal from the tree.</i></p></p>
<p><b>is_full</b><b>(</b><b>): </b>Boolean
<p style="padding-left: 2em"><i>Returns if this Merkle tree is full and further items cannot be directly inserted.</i></p>
<p style="color: royalblue; padding-left: 2em"><i>available from Typescript as <b>isFull</b><b>(</b><b>): </b>boolean</i></p></p>
<p><b>reset_history</b><b>(</b><b>): </b>[]
<p style="padding-left: 2em"><i>Resets the history for this Merkle tree, leaving only the current root valid.</i></p></p>
<p><b>reset_to_default</b><b>(</b><b>): </b>[]
<p style="padding-left: 2em"><i>Resets this Merkle tree to the empty Merkle tree.</i></p></p>
<p style="color: royalblue"><b>findPathForLeaf</b><b>(</b>leaf: value_type<b>): </b>MerkleTreePath&lt;value_type&gt; | undefined</p>
<p style="color: royalblue; padding-left: 2em"><i>Finds the path for a given leaf in a Merkle tree. Be warned that this is O(n) and should be avoided for large trees. Returns undefined if no such leaf exists. 
    MerkleTreePath is defined in compact-runtime runtime.ts.</i></p>
<p style="color: royalblue; padding-left: 2em"><i>callable only from Typescript</i></p>
<p style="color: royalblue"><b>firstFree</b><b>(</b><b>): </b>bigint</p>
<p style="color: royalblue; padding-left: 2em"><i>Retrieves the first (guaranteed) free index in the Merkle tree.</i></p>
<p style="color: royalblue; padding-left: 2em"><i>callable only from Typescript</i></p>
<p style="color: royalblue"><b>history</b><b>(</b><b>): </b>Iterator&lt;MerkleTreeDigest&gt;</p>
<p style="color: royalblue; padding-left: 2em"><i>An iterator over the roots that are considered valid past roots for this Merkle tree. MerkleTreeDigest is defined in compact-runtime runtime.ts.</i></p>
<p style="color: royalblue; padding-left: 2em"><i>callable only from Typescript</i></p>
<p style="color: royalblue"><b>pathForLeaf</b><b>(</b>index: bigint, leaf: value_type<b>): </b>MerkleTreePath&lt;value_type&gt;</p>
<p style="color: royalblue; padding-left: 2em"><i>Returns the Merkle path, given the knowledge that a specified leaf is at the given index. It is an error to call this if this leaf is not contained at the given index. MerkleTreePath is defined in compact-runtime runtime.ts.</i></p>
<p style="color: royalblue; padding-left: 2em"><i>callable only from Typescript</i></p>
<p style="color: royalblue"><b>root</b><b>(</b><b>): </b>MerkleTreeDigest</p>
<p style="color: royalblue; padding-left: 2em"><i>Retrieves the root of the Merkle tree. MerkleTreeDigest is defined in compact-runtime runtime.ts.</i></p>
<p style="color: royalblue; padding-left: 2em"><i>callable only from Typescript</i></p>
</blockquote>

</body></html>